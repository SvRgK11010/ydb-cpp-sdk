permissions:

  iam.permissionStages.get:
    description: Get IAM permission stages
    stage: GA
    visibility: internal
  iam.permissionStages.create:
    description: Create IAM permission stages
    stage: GA
    visibility: internal

  iam.resourceTypes.get:
    description: Get IAM resource types
    stage: GA
    visibility: internal
  iam.resourceTypes.create:
    description: Create IAM resource types
    stage: GA
    visibility: internal
  iam.resourceTypes.update:
    description: Update IAM resource types
    stage: GA
    visibility: internal
  iam.resourceTypes.listRestrictions:
    description: List assignment of restrictions on all resources of particular type
    stage: GA
    visibility: internal
    resourceType: iam.resourceType
  iam.resourceTypes.updateRestrictions:
    description: Manage assignment of restrictions on all resources of particular type
    stage: GA
    visibility: internal
    resourceType: iam.resourceType

  iam.permissions.get:
    description: Get IAM permissions
    stage: GA
    visibility: internal
  iam.permissions.create:
    description: Create IAM permissions
    stage: GA
    visibility: internal
  iam.permissions.update:
    description: Update IAM permissions
    stage: GA
    visibility: internal

  iam.roles.get:
    description: Get IAM roles
    stage: GA
    visibility: internal
  iam.roles.create:
    description: Create IAM roles
    stage: GA
    visibility: internal
  iam.roles.update:
    description: Update IAM roles
    stage: GA
    visibility: internal

  iam.restrictionTypes.get:
    description: Get IAM restriciton types
    stage: GA
    visibility: internal
    resourceType: iam.restrictionType
  iam.restrictionTypes.create:
    description: Create IAM restriction types
    stage: GA
    visibility: internal
    resourceType: iam.gizmo
  iam.restrictionTypes.update:
    description: Update IAM restriction types
    stage: GA
    visibility: internal
    resourceType: iam.restrictionType
  iam.restrictionTypes.listAccessBindings:
    description: List access bindings on restriction type
    stage: GA
    visibility: internal
    resourceType: iam.restrictionType
  iam.restrictionTypes.updateAccessBindings:
    description: Update access bindings on restriction type
    stage: GA
    visibility: internal
    resourceType: iam.restrictionType
  iam.restrictionTypes.use:
    description: Manage particular type of restriction on resources
    stage: GA
    visibility: internal
    resourceType: iam.restrictionType

  iam.oauthScopes.get:
    description: Get OAuth scopes
    stage: GA
    visibility: internal
  iam.oauthScopes.create:
    description: Create OAuth scopes
    stage: GA
    visibility: internal
  iam.oauthScopes.update:
    description: Update OAuth scopes
    stage: GA
    visibility: internal

  iam.oauthClients.get:
    description: Get OAuth clients
    stage: GA
    visibility: internal
  iam.oauthClients.create:
    description: Create OAuth clients
    stage: GA
    visibility: internal
  iam.oauthClients.update:
    description: Update OAuth clients
    stage: GA
    visibility: internal

  iam.accessBinding.delete:
    description: Delete role assignment
    stage: GA
    visibility: public
    allowedWhen:
      restrictions:
        - billSuspend
        - fraud
        - deletingContainer
      cloud:
        status:
          - ACTIVE
          - BLOCKED_BY_BILLING
          - DELETING
  iam.accessBindings.list:
    description: List all role assignments
    stage: GA
    visibility: public
    allowedWhen:
      cloud:
        status:
        - BLOCKED
        - BLOCKED_BY_BILLING
        - CREATING
        - ACTIVE
        - DELETING
  iam.accessBindings.manageOwners:
    description: Manage owner roles in a cloud
    stage: GA
    visibility: public
    allowedWhen:
      restrictions:
        - freeTier
        - billSuspend
      cloud:
        status:
        - BLOCKED_BY_BILLING
        - CREATING
        - ACTIVE
  iam.accessBindings.set:
    description: Create role assignment
    stage: GA
    visibility: public
    allowedWhen:
      cloud:
        status:
        - BLOCKED_BY_BILLING
        - CREATING
        - ACTIVE
  iam.accessBindings.update:
    description: Create role assignment
    stage: GA
    visibility: public
    allowedWhen:
      cloud:
        status:
        - BLOCKED_BY_BILLING
        - CREATING
        - ACTIVE
  iam.accessBindings.changeTopLevelResource:
    description: Change top level resource of access bindings
    stage: GA
    visibility: internal
  iam.accessBindings.deleteByTopLevelResource:
    description: Delete access bindings by top level resource
    stage: GA
    visibility: internal

  iam.cloud.update:
    # TODO: rename
    description: Edits an cloud
    stage: GA
    visibility: public
    allowedWhen:
      cloud:
        status:
        - ACTIVE

  iam.cloudOperations.list:
    description: List cloud operations
    stage: GA
    visibility: public
    allowedWhen:
      restrictions:
        - billSuspend
        - fraud
        - deletingContainer
      cloud:
        status:
        - BLOCKED
        - BLOCKED_BY_BILLING
        - ACTIVE
        - DELETING

  iam.cloudUser.create:
    description: Create user in cloud
    stage: GA
    visibility: public
    allowedWhen:
      cloud:
        status:
        - ACTIVE
  iam.cloudUser.delete:
    description: Deletes a user
    stage: GA
    visibility: public
    allowedWhen:
      restrictions:
        - billSuspend
        - fraud
        - deletingContainer
      cloud:
        status:
          - ACTIVE
          - BLOCKED_BY_BILLING
          - DELETING
  iam.cloudUser.get:
    description: Get one user in a given cloud
    stage: GA
    visibility: public
    allowedWhen:
      restrictions:
        - billSuspend
        - fraud
        - deletingContainer
      cloud:
        status:
        - BLOCKED
        - BLOCKED_BY_BILLING
        - ACTIVE
        - DELETING
  iam.cloudUsers.list:
    description: List users in a cloud
    stage: GA
    visibility: public
    allowedWhen:
      restrictions:
        - billSuspend
      cloud:
        status:
        - BLOCKED
        - BLOCKED_BY_BILLING
        - ACTIVE
  iam.cloudUsers.superList:
    description: List users in a cloud with disabled user listing
    stage: GA
    visibility: public
    allowedWhen:
      restrictions:
        - freeTier
        - billSuspend
        - fraud
        - deletingContainer
      cloud:
        status:
        - BLOCKED
        - BLOCKED_BY_BILLING
        - ACTIVE
        - DELETING

  iam.clouds.delete:
    description: Deletes an cloud
    stage: GA
    visibility: public
    allowedWhen:
      restrictions:
        - billSuspend
        - fraud
        - deletingContainer
      cloud:
        status:
          - ACTIVE
          - BLOCKED_BY_BILLING
          - DELETING
  iam.clouds.get:
    description: Returns a single cloud
    stage: GA
    visibility: public
    allowedWhen:
      restrictions:
        - freeTier
        - billSuspend
        - fraud
        - deletingContainer
      cloud:
        status:
        - CREATING
        - ACTIVE
        - BLOCKED_BY_BILLING
        - DELETING
    resourceType: resource-manager.cloud
  iam.clouds.getSettings:
    description: Returns a single cloud settings
    stage: GA
    visibility: public
    allowedWhen:
      restrictions:
        - freeTier
        - billSuspend
        - fraud
        - deletingContainer
      cloud:
        status:
          - CREATING
          - ACTIVE
          - BLOCKED_BY_BILLING
          - DELETING
  iam.clouds.updateSettings:
    description: Updates a single cloud settings
    stage: GA
    visibility: public
    allowedWhen:
      restrictions:
        - freeTier
        - billSuspend
      cloud:
        status:
          - CREATING
          - BLOCKED
          - BLOCKED_BY_BILLING
          - ACTIVE
          - DELETING
  iam.clouds.list:
    description: List clouds where current user has membership
    stage: GA
    visibility: public
    allowedWhen:
      restrictions:
        - billSuspend
        - fraud
        - deletingContainer
      cloud:
        status:
        - BLOCKED
        - BLOCKED_BY_BILLING
        - ACTIVE
        - DELETING
  iam.clouds.setDefaultZone:
    description: ''
    stage: GA
    visibility: public
    allowedWhen:
      cloud:
        status:
        - ACTIVE
  iam.clouds.setUserListingSetting:
    description: ''
    stage: GA
    visibility: public
    allowedWhen:
      cloud:
        status:
        - ACTIVE
    resourceType: resource-manager.cloud

  iam.federations.create:
    description: ''
    stage: IAM_FOLDER_SAML_FEDERATIONS
    visibility: public
    allowedWhen:
      cloud:
        status:
        - ACTIVE
    resourceType: resource-manager.folder
  iam.federations.createCertificate:
    description: ''
    stage: GA
    visibility: public
    allowedWhen:
      cloud:
        status:
        - ACTIVE
    resourceType: iam.federation
  iam.federations.createUser:
    description: ''
    stage: GA
    visibility: public
    allowedWhen:
      cloud:
        status:
        - ACTIVE
    resourceType: iam.federation
  iam.federations.delete:
    description: ''
    stage: GA
    visibility: public
    allowedWhen:
      restrictions:
        - billSuspend
        - fraud
        - deletingContainer
      cloud:
        status:
          - ACTIVE
          - BLOCKED_BY_BILLING
          - DELETING
    resourceType: iam.federation
  iam.federations.deleteCertificate:
    description: ''
    stage: GA
    visibility: public
    allowedWhen:
      restrictions:
        - billSuspend
        - fraud
        - deletingContainer
      cloud:
        status:
          - ACTIVE
          - BLOCKED_BY_BILLING
          - DELETING
    resourceType: iam.federationCertificate
  iam.federations.deleteUser:
    description: ''
    stage: GA
    visibility: public
    allowedWhen:
      restrictions:
        - billSuspend
        - fraud
        - deletingContainer
      cloud:
        status:
          - ACTIVE
          - BLOCKED_BY_BILLING
          - DELETING
  iam.federations.get:
    description: ''
    stage: GA
    visibility: public
    allowedWhen:
      restrictions:
        - billSuspend
        - fraud
        - deletingContainer
      cloud:
        status:
        - BLOCKED
        - BLOCKED_BY_BILLING
        - ACTIVE
        - DELETING
    resourceType: iam.federation
  iam.federations.getCertificate:
    description: ''
    stage: GA
    visibility: public
    allowedWhen:
      restrictions:
        - billSuspend
        - fraud
        - deletingContainer
      cloud:
        status:
        - BLOCKED
        - BLOCKED_BY_BILLING
        - ACTIVE
        - DELETING
    resourceType: iam.federationCertificate
  iam.federations.list:
    description: ''
    stage: GA
    visibility: public
    allowedWhen:
      restrictions:
        - billSuspend
        - fraud
        - deletingContainer
      cloud:
        status:
        - BLOCKED
        - BLOCKED_BY_BILLING
        - ACTIVE
        - DELETING
    resourceType: resource-manager.folder
  iam.federations.listCertificate:
    description: ''
    stage: GA
    visibility: public
    allowedWhen:
      restrictions:
        - billSuspend
        - fraud
        - deletingContainer
      cloud:
        status:
        - BLOCKED
        - BLOCKED_BY_BILLING
        - ACTIVE
        - DELETING
    resourceType: iam.federation
  iam.federations.update:
    description: ''
    stage: GA
    visibility: public
    allowedWhen:
      cloud:
        status:
        - ACTIVE
    resourceType: iam.federation
  iam.federations.updateCertificate:
    description: ''
    stage: GA
    visibility: public
    allowedWhen:
      cloud:
        status:
        - ACTIVE
    resourceType: iam.federationCertificate

  iam.federatedUsers.crossCloudBindings:
    description: ''
    stage: GA
    visibility: internal
    resourceType: iam.userAccount

  iam.folderOperations.list:
    description: List folder operations
    stage: GA
    visibility: public
    allowedWhen:
      restrictions:
        - billSuspend
        - fraud
        - deletingContainer
      cloud:
        status:
        - BLOCKED
        - BLOCKED_BY_BILLING
        - ACTIVE
        - DELETING

  iam.folders.create:
    description: Create folder
    stage: GA
    visibility: public
    allowedWhen:
      cloud:
        status:
        - ACTIVE
    resourceType: resource-manager.cloud
  iam.folders.delete:
    description: Deletes a folder
    stage: GA
    visibility: public
    allowedWhen:
      restrictions:
        - billSuspend
        - fraud
        - deletingContainer
      cloud:
        status:
          - ACTIVE
          - BLOCKED_BY_BILLING
          - DELETING
    resourceType: resource-manager.folder
  iam.folders.get:
    description: Returns a single folder
    stage: GA
    visibility: public
    allowedWhen:
      restrictions:
        - billSuspend
        - fraud
        - deletingContainer
      cloud:
        status:
        - BLOCKED
        - BLOCKED_BY_BILLING
        - ACTIVE
        - DELETING
    resourceType: resource-manager.folder
  iam.folders.getSettings:
    description: Returns a single folder settings
    stage: GA
    visibility: public
    allowedWhen:
      restrictions:
        - freeTier
        - billSuspend
        - fraud
        - deletingContainer
      cloud:
        status:
        - CREATING
        - BLOCKED
        - BLOCKED_BY_BILLING
        - ACTIVE
        - DELETING
  iam.folders.updateSettings:
    description: Updates a single folder settings
    stage: GA
    visibility: public
    allowedWhen:
      restrictions:
        - freeTier
        - billSuspend
      cloud:
        status:
          - CREATING
          - BLOCKED
          - BLOCKED_BY_BILLING
          - ACTIVE
          - DELETING
  iam.folders.list:
    description: List folders in an cloud
    stage: GA
    visibility: public
    allowedWhen:
      restrictions:
        - billSuspend
        - fraud
        - deletingContainer
      cloud:
        status:
        - BLOCKED
        - BLOCKED_BY_BILLING
        - ACTIVE
        - DELETING
    resourceType: resource-manager.cloud
  iam.folders.update:
    description: Update folder
    stage: GA
    visibility: public
    allowedWhen:
      cloud:
        status:
        - ACTIVE
    resourceType: resource-manager.folder

  iam.operations.get:
    description: Get operation
    stage: GA
    visibility: public
    allowedWhen:
      restrictions:
        - billSuspend
        - fraud
        - deletingContainer
      cloud:
        status:
        - BLOCKED
        - BLOCKED_BY_BILLING
        - ACTIVE
        - DELETING
  iam.operations.list:
    description: Get operation
    stage: GA
    visibility: public
    allowedWhen:
      restrictions:
        - billSuspend
        - fraud
        - deletingContainer
      cloud:
        status:
        - BLOCKED
        - BLOCKED_BY_BILLING
        - ACTIVE
        - DELETING

  iam.roles.list:
    description: Get the list of global roles in an cloud
    stage: GA
    visibility: public
    allowedWhen:
      restrictions:
        - billSuspend
        - fraud
        - deletingContainer
      cloud:
        status:
        - BLOCKED
        - BLOCKED_BY_BILLING
        - ACTIVE
        - DELETING

  iam.serviceAccounts.create:
    description: ''
    stage: GA
    visibility: public
    allowedWhen:
      cloud:
        status:
        - ACTIVE
    resourceType: resource-manager.folder
  iam.serviceAccounts.createForHost:
    description: ''
    stage: GA
    visibility: public
  iam.serviceAccounts.delete:
    description: ''
    stage: GA
    visibility: public
    allowedWhen:
      restrictions:
        - billSuspend
        - fraud
        - deletingContainer
      cloud:
        status:
          - ACTIVE
          - BLOCKED_BY_BILLING
          - DELETING
    resourceType: iam.serviceAccount
  iam.serviceAccounts.getAccessKey:
    description: ''
    stage: GA
    visibility: public
    allowedWhen:
      restrictions:
        - billSuspend
        - fraud
        - deletingContainer
      cloud:
        status:
        - BLOCKED
        - BLOCKED_BY_BILLING
        - ACTIVE
        - DELETING
    resourceType: iam.serviceAccount
  iam.serviceAccounts.createAccessKey:
    description: Create access key for service account
    stage: GA
    visibility: public
    allowedWhen:
      cloud:
        status:
        - ACTIVE
    resourceType: iam.serviceAccount
  iam.serviceAccounts.createAccessKeyWithPrefix:
    description: Create access key for service account with regional prefix
    stage: IAM_ACCESS_KEY_PREFIX
    visibility: internal
    allowedWhen:
      cloud:
        status:
        - ACTIVE
    resourceType: iam.serviceAccount
  iam.serviceAccounts.updateAccessKey:
    description: ''
    stage: GA
    visibility: public
    allowedWhen:
      restrictions:
        - billSuspend
      cloud:
        status:
          - ACTIVE
          - BLOCKED_BY_BILLING
          - DELETING
    resourceType: iam.serviceAccount
  iam.serviceAccounts.deleteAccessKey:
    description: ''
    stage: GA
    visibility: public
    allowedWhen:
      restrictions:
        - billSuspend
        - fraud
        - deletingContainer
      cloud:
        status:
          - ACTIVE
          - BLOCKED_BY_BILLING
          - DELETING
    resourceType: iam.serviceAccount
  iam.serviceAccounts.getApiKey:
    description: ''
    stage: GA
    visibility: public
    allowedWhen:
      restrictions:
        - billSuspend
        - fraud
        - deletingContainer
      cloud:
        status:
        - BLOCKED
        - BLOCKED_BY_BILLING
        - ACTIVE
        - DELETING
    resourceType: iam.serviceAccount
  iam.serviceAccounts.createApiKey:
    description: ''
    stage: GA
    visibility: public
    allowedWhen:
      cloud:
        status:
          - ACTIVE
    resourceType: iam.serviceAccount
  iam.serviceAccounts.updateApiKey:
    description: ''
    stage: GA
    visibility: public
    allowedWhen:
      restrictions:
        - billSuspend
      cloud:
        status:
          - ACTIVE
          - BLOCKED_BY_BILLING
          - DELETING
    resourceType: iam.serviceAccount
  iam.serviceAccounts.deleteApiKey:
    description: ''
    stage: GA
    visibility: public
    allowedWhen:
      restrictions:
        - billSuspend
        - fraud
        - deletingContainer
      cloud:
        status:
          - ACTIVE
          - BLOCKED_BY_BILLING
          - DELETING
    resourceType: iam.serviceAccount
  iam.serviceAccounts.getSshKey:
    description: ''
    stage: GA
    visibility: public
    allowedWhen:
      restrictions:
        - billSuspend
        - fraud
        - deletingContainer
      cloud:
        status:
        - BLOCKED
        - BLOCKED_BY_BILLING
        - ACTIVE
        - DELETING
    resourceType: iam.serviceAccount
  iam.serviceAccounts.createSshKey:
    description: ''
    stage: GA
    visibility: public
    allowedWhen:
      cloud:
        status:
          - ACTIVE
    resourceType: iam.serviceAccount
  iam.serviceAccounts.deleteSshKey:
    description: ''
    stage: GA
    visibility: public
    allowedWhen:
      restrictions:
        - billSuspend
        - fraud
        - deletingContainer
      cloud:
        status:
          - ACTIVE
          - BLOCKED_BY_BILLING
          - DELETING
    resourceType: iam.serviceAccount
  iam.userAccounts.getSshKey:
    description: ''
    stage: GA
    visibility: public
    allowedWhen:
      restrictions:
        - billSuspend
        - fraud
        - deletingContainer
      cloud:
        status:
        - BLOCKED
        - BLOCKED_BY_BILLING
        - ACTIVE
        - DELETING
    resourceType: iam.userAccount
  iam.userAccounts.createSshKey:
    description: ''
    stage: GA
    visibility: public
    allowedWhen:
      cloud:
        status:
          - ACTIVE
    resourceType: iam.userAccount
  iam.userAccounts.deleteSshKey:
    description: ''
    stage: GA
    visibility: public
    allowedWhen:
      restrictions:
        - billSuspend
        - fraud
        - deletingContainer
      cloud:
        status:
          - ACTIVE
          - BLOCKED_BY_BILLING
          - DELETING
    resourceType: iam.userAccount
  iam.userAccounts.getSettings:
    description: 'Чтение userSettings пользователя'
    stage: GA
    visibility: public
    resourceType: iam.userAccount
  iam.serviceAccounts.get:
    description: ''
    stage: GA
    visibility: public
    allowedWhen:
      restrictions:
        - billSuspend
        - fraud
        - deletingContainer
      cloud:
        status:
        - BLOCKED
        - BLOCKED_BY_BILLING
        - ACTIVE
        - DELETING
    resourceType: iam.serviceAccount
  iam.serviceAccounts.issueToken:
    description: ''
    stage: GA
    visibility: public
    resourceType: iam.serviceAccount
  iam.serviceAccounts.issueCookie:
    description: ''
    stage: GA
    visibility: internal
    resourceType: iam.serviceAccount
  iam.serviceAccounts.issueTokenForInstance:
    description: ''
    stage: GA
    visibility: public
    resourceType: iam.serviceAccount
  iam.serviceAccounts.issueTokenForRestrictedAlgorithm:
    description: ''
    stage: GA
    visibility: internal
    resourceType: iam.serviceAccount
  iam.serviceAccounts.list:
    description: ''
    stage: GA
    visibility: public
    allowedWhen:
      restrictions:
        - billSuspend
        - fraud
        - deletingContainer
      cloud:
        status:
        - BLOCKED
        - BLOCKED_BY_BILLING
        - ACTIVE
        - DELETING
    resourceType: resource-manager.folder
  iam.serviceAccounts.listAccessKeys:
    description: ''
    stage: GA
    visibility: public
    allowedWhen:
      restrictions:
        - billSuspend
        - fraud
        - deletingContainer
      cloud:
        status:
        - BLOCKED
        - BLOCKED_BY_BILLING
        - ACTIVE
        - DELETING
    resourceType: iam.serviceAccount
  iam.accessKeys.listByFingerprint:
    description: List access keys by secret key fingerprint
    stage: GA
    visibility: internal
  iam.serviceAccounts.listApiKeys:
    description: ''
    stage: GA
    visibility: public
    allowedWhen:
      restrictions:
        - billSuspend
        - fraud
        - deletingContainer
      cloud:
        status:
        - BLOCKED
        - BLOCKED_BY_BILLING
        - ACTIVE
        - DELETING
    resourceType: iam.serviceAccount
  iam.serviceAccounts.update:
    description: ''
    stage: GA
    visibility: public
    allowedWhen:
      cloud:
        status:
        - ACTIVE
    resourceType: iam.serviceAccount
  iam.serviceAccounts.use:
    description: ''
    stage: GA
    visibility: public
    allowedWhen:
      cloud:
        status:
        - ACTIVE
  iam.serviceAccounts.crossCloudBindings:
    description: ''
    stage: GA
    visibility: internal
    resourceType: iam.serviceAccount
    allowedWhen:
      cloud:
        status:
          - ACTIVE
  iam.serviceAccounts.listAccessBindings:
    description: ''
    stage: GA
    visibility: public
    resourceType: iam.serviceAccount
    allowedWhen:
      restrictions:
        - freeTier
        - billSuspend
        - fraud
        - deletingContainer
      cloud:
        status:
        - BLOCKED
        - BLOCKED_BY_BILLING
        - CREATING
        - ACTIVE
        - DELETING
  iam.serviceAccounts.updateAccessBindings:
    description: ''
    stage: GA
    visibility: public
    resourceType: iam.serviceAccount
    allowedWhen:
      restrictions:
        - freeTier
        - billSuspend
      cloud:
        status:
        - BLOCKED_BY_BILLING
        - CREATING
        - ACTIVE
  iam.tokenKeys.create:
    description: ''
    stage: GA
    visibility: public
    allowedWhen:
      cloud:
        status:
        - ACTIVE
    resourceType:
      oneOf: [iam.serviceAccount, iam.userAccount]
  iam.tokenKeys.update:
    description: ''
    stage: GA
    visibility: public
    allowedWhen:
      cloud:
        status:
          - ACTIVE
    resourceType:
      oneOf: [iam.serviceAccount, iam.userAccount]
  iam.tokenKeys.delete:
    description: ''
    stage: GA
    visibility: public
    allowedWhen:
      restrictions:
        - billSuspend
        - fraud
        - deletingContainer
      cloud:
        status:
          - ACTIVE
          - BLOCKED_BY_BILLING
          - DELETING
    resourceType:
      oneOf: [iam.serviceAccount, iam.userAccount]
  iam.tokenKeys.get:
    description: ''
    stage: GA
    visibility: public
    allowedWhen:
      restrictions:
        - billSuspend
        - fraud
        - deletingContainer
      cloud:
        status:
        - BLOCKED
        - BLOCKED_BY_BILLING
        - ACTIVE
        - DELETING
    resourceType:
      oneOf: [iam.serviceAccount, iam.userAccount]

  iam.authorizedKeys.create:
    description: Create authorized key
    stage: GA
    visibility: public
    allowedWhen:
      cloud:
        status:
        - ACTIVE
    resourceType:
      oneOf: [iam.serviceAccount, iam.userAccount]
  iam.authorizedKeys.update:
    description: Update authorized key
    stage: GA
    visibility: public
    allowedWhen:
      cloud:
        status:
          - ACTIVE
    resourceType:
      oneOf: [iam.serviceAccount, iam.userAccount]
  iam.authorizedKeys.delete:
    description: Delete authorized key
    stage: GA
    visibility: public
    allowedWhen:
      restrictions:
        - billSuspend
        - fraud
        - deletingContainer
      cloud:
        status:
          - ACTIVE
          - BLOCKED_BY_BILLING
          - DELETING
    resourceType:
      oneOf: [iam.serviceAccount, iam.userAccount]
  iam.authorizedKeys.get:
    description: Get authorized key
    stage: GA
    visibility: public
    allowedWhen:
      restrictions:
        - billSuspend
        - fraud
        - deletingContainer
      cloud:
        status:
          - BLOCKED
          - BLOCKED_BY_BILLING
          - ACTIVE
          - DELETING
    resourceType:
      oneOf: [iam.serviceAccount, iam.userAccount]
  iam.authorizedKeys.listByFingerprint:
    description: List authorized keys by public key fingerprint
    stage: GA
    visibility: internal

  iam.userAccounts.createAccessKey:
    description: Create user access key
    stage: GA
    visibility: internal
    allowedWhen:
      cloud:
        status:
        - ACTIVE
    resourceType: iam.userAccount
  iam.userAccounts.createAccessKeyWithPrefix:
    description: Create user access key with regional prefix
    stage: IAM_ACCESS_KEY_PREFIX
    visibility: internal
    allowedWhen:
      cloud:
        status:
          - ACTIVE
    resourceType: iam.userAccount
  iam.userAccounts.deleteAccessKey:
    description: Delete user access key
    stage: GA
    visibility: internal
    allowedWhen:
      restrictions:
        - billSuspend
        - fraud
        - deletingContainer
      cloud:
        status:
          - ACTIVE
          - BLOCKED_BY_BILLING
          - DELETING
    resourceType: iam.userAccount
  iam.userAccounts.getAccessKey:
    description: Get user access key
    stage: GA
    visibility: internal
    allowedWhen:
      restrictions:
        - billSuspend
        - fraud
        - deletingContainer
      cloud:
        status:
        - BLOCKED
        - BLOCKED_BY_BILLING
        - ACTIVE
        - DELETING
    resourceType: iam.userAccount
  iam.userAccounts.listAccessKeys:
    description: List user access keys
    stage: GA
    visibility: internal
    allowedWhen:
      restrictions:
        - billSuspend
        - fraud
        - deletingContainer
      cloud:
        status:
          - BLOCKED
          - BLOCKED_BY_BILLING
          - ACTIVE
          - DELETING
    resourceType: iam.userAccount
  iam.userAccounts.updateAccessKey:
    description: Update user access key
    stage: GA
    visibility: internal
    allowedWhen:
      restrictions:
        - billSuspend
      cloud:
        status:
          - ACTIVE
          - BLOCKED_BY_BILLING
          - DELETING
    resourceType: iam.userAccount

  iam.userAccounts.createManaged:
    description: 'Create a user account that is managed by an external system.'
    stage: GA
    visibility: internal
    resourceType: iam.gizmo

  iam.userAccounts.delete:
    description: 'Delete a user account.'
    stage: GA
    visibility: internal
    resourceType: iam.gizmo

  iam.userAccounts.get:
    description: ''
    stage: GA
    visibility: public
    allowedWhen:
      restrictions:
        - billSuspend
        - fraud
        - deletingContainer
      cloud:
        status:
        - BLOCKED
        - BLOCKED_BY_BILLING
        - ACTIVE
        - DELETING

  iam.subjects.issueCookie:
    description: 'Issue cookie for subject'
    stage: GA
    visibility: internal
    resourceType:
      oneOf: [iam.serviceAccount, iam.userAccount]

  iam.subjects.issueToken:
    description: 'Issue token for subject'
    stage: GA
    visibility: internal
    resourceType:
      oneOf: [iam.serviceAccount, iam.userAccount]

  iam.userAccounts.issueCookie:
    description: 'Issue cookie for user account'
    stage: GA
    visibility: internal
    resourceType: iam.userAccount

  iam.userAccounts.issueToken:
    description: 'Issue token for user account'
    stage: GA
    visibility: internal
    resourceType: iam.userAccount

  iam.userAccounts.issueTokenFromJwt:
    description: 'Issue token for user account from JWT'
    stage: GA
    visibility: internal
    resourceType: iam.userAccount

  iam.userAccounts.createTotpProfile:
    description: 'Create TOTP profile for user account'
    stage: GA
    visibility: internal
    resourceType: iam.userAccount

  iam.userAccounts.presignUrl:
    description: 'Create signature for storage URL'
    stage: GA
    visibility: internal
    resourceType: iam.userAccount

  iam.userOperations.list:
    description: List user operations
    stage: GA
    visibility: public
    allowedWhen:
      restrictions:
        - billSuspend
        - fraud
        - deletingContainer
      cloud:
        status:
        - BLOCKED
        - BLOCKED_BY_BILLING
        - ACTIVE
        - DELETING

  iam.resourceTypes.membership:
    description: Special permission granting membership in a top-level resource
    stage: GA
    visibility: public

  iam.resourceTypes.listMemberships:
    description: View top-level resource members and member resources
    stage: GA
    visibility: internal
    resourceType: iam.resourceType

  iam.resourceTypes.listAccessBindings:
    description: List access bindings on resource type
    stage: GA
    visibility: internal
    resourceType: iam.resourceType

  iam.resourceTypes.updateAccessBindings:
    description: Update access bindings on resource type
    stage: GA
    visibility: internal
    resourceType: iam.resourceType

  iam.gizmo.listAccessBindings:
    description: List gizmo access bindings
    stage: GA
    visibility: internal
    resourceType: iam.resourceType

  iam.gizmo.updateAccessBindings:
    description: Update gizmo access bindings
    stage: GA
    visibility: internal
    resourceType: iam.resourceType

  iam.root.listAccessBindings:
    description: List root access bindings
    stage: GA
    visibility: internal
    resourceType: iam.resourceType

  iam.root.updateAccessBindings:
    description: Update root access bindings
    stage: GA
    visibility: internal
    resourceType: iam.resourceType

  iam.subjects.getOsLogin:
    description: Get OS login information of a subject
    stage: GA
    visibility: internal
    resourceType: iam.subject
    allowedWhen:
      restrictions:
        - billSuspend
        - fraud
        - deletingContainer
      cloud:
        status:
          - BLOCKED
          - BLOCKED_BY_BILLING
          - ACTIVE
          - DELETING

  iam.subjects.updateOsLogin:
    description: Update OS login information of a subject
    stage: GA
    visibility: internal
    resourceType: iam.subject
    allowedWhen:
      cloud:
        status:
          - ACTIVE

  iam.quotas.get:
    description: Get IAM quotas
    stage: GA
    visibility: public
    resourceType: resource-manager.cloud
    allowedWhen:
      restrictions:
        - billSuspend
        - fraud
        - deletingContainer
      cloud:
        status:
          - BLOCKED
          - BLOCKED_BY_BILLING
          - ACTIVE
          - DELETING

  iam.quotas.updateLimit:
    description: Update IAM quotas
    stage: GA
    visibility: internal
    resourceType: resource-manager.cloud
    allowedWhen:
      restrictions:
        - billSuspend
      cloud:
        status:
          - BLOCKED
          - BLOCKED_BY_BILLING
          - ACTIVE
          - DELETING

  iam.internal.diagnostics:
    description: Usage of intenal diagnostic tools
    stage: GA
    visibility: internal
    resourceType: iam.gizmo

  iam.totpProfiles.manage:
    description: ''
    stage: GA
    visibility: internal
    resourceType: iam.totpProfile

  iam.invitees.getOrCreate:
    description: Create (or get if exists) invitees
    stage: GA
    visibility: internal
    resourceType: iam.gizmo

  iam.subjects.merge:
    description: Merge subjects
    stage: GA
    visibility: internal
    resourceType: iam.gizmo

  iam.subjects.delete:
    description: Delete subjects
    stage: GA
    visibility: internal
    resourceType: iam.gizmo
