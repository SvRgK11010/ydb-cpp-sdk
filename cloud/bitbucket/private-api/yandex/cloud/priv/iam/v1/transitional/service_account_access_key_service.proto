syntax = "proto3";

package yandex.cloud.priv.iam.v1.transitional;

import "google/api/annotations.proto";
import "google/protobuf/empty.proto";

option go_package = "a.yandex-team.ru/cloud/bitbucket/private-api/yandex/cloud/priv/iam/v1/transitional;iam";
option java_outer_classname = "PTSAAKS";

service ServiceAccountAccessKeyService {
  rpc PresignUrl (PresignUrlRequest) returns (PresignUrlResponse) {
    option (google.api.http) = { post: "/iam/v1/presignURL" body: "*" };
  }

  rpc PresignUrls (PresignUrlsRequest) returns (PresignUrlsResponse) {
    option (google.api.http) = { post: "/iam/v1/presignURLs" body: "*" };
  }

  rpc GetCurrentPresignKey (google.protobuf.Empty) returns (PresignKey) {
    option (google.api.http) = { get: "/iam/v1/presignURL:getCurrentKey" };
  }
}

message PresignUrlRequest {
  string key_id = 1; // TODO not cloud ID
  string string_to_sign = 2;
  string version = 3; // TODO enum
  string region = 4;
  string service = 5;
}

message PresignUrlResponse {
  string result = 1;
  string signature = 2;
  string key_id = 3;
}

message PresignUrlsRequest {
  string key_id = 1; // TODO not cloud ID
  repeated string strings_to_sign = 2;
  string version = 3; // TODO enum
  string region = 4;
  string service = 5;
}

message PresignUrlsResponse {
  string key_id = 1;
  repeated string signatures = 2;
}

message PresignKey {
  string key_id = 1;
}
